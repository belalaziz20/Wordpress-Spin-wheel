!function(){console.log("Spin Wheel JS Loaded");const e=(WOF_LocalizeConfig?.wheel_data?.frontEndVisibility?.campaign_name||"Happy Offers").replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),t={setCookie:function(t,o,n){const i=e+"_"+t;let l="";if(n){const e=new Date;e.setTime(e.getTime()+24*n*60*60*1e3),l="; expires="+e.toUTCString()}document.cookie=i+"="+(o||"")+l+"; path=/"},getCookie:function(t){const o=e+"_"+t+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let t=n[e];for(;" "===t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(o))return t.substring(o.length,t.length)}return null},createImages:function(){WOF_LocalizeConfig?.wheel_data?.wheelStyles?.othersData?.centerImage&&"none"!==WOF_LocalizeConfig?.wheel_data?.wheelStyles?.othersData?.centerImage?this.imgElement=this.createImageElement("spin-wheel-img",WOF_LocalizeConfig?.wheel_data?.wheelStyles?.othersData?.centerImage):this.imgElement=this.createImageElement("spin-wheel-img",WOF_LocalizeConfig.assetsUrl+"imgs/example-0-image.svg"),WOF_LocalizeConfig?.wheel_data?.wheelStyles?.othersData?.centerImageOverlay?this.imgOverlayElement=this.createImageElement("spin-wheel-img-overlay",WOF_LocalizeConfig?.wheel_data?.wheelStyles?.othersData?.centerImageOverlay):this.imgOverlayElement=this.createImageElement("spin-wheel-img-overlay",WOF_LocalizeConfig.assetsUrl+"imgs/example-0-overlay.svg")},createImageElement:function(e,t){const o=document.createElement("img");return o.src=t,o.id=e,o.style.display="none",document.body.appendChild(o),o},setupWheel:function(){const e=document.querySelector("#spin-wheel");this.wheel=new spinWheel.Wheel(e,this.props)},bindEvents:function(){document.addEventListener("click",(e=>{if(e.target.matches("#spin-wheel-spin-btn")){e.preventDefault();const t=document.querySelector('.spin-wheel-forms-spin input[name="name"]').value,o=document.querySelector('.spin-wheel-forms-spin input[name="email"]').value,n=document.querySelector('.spin-wheel-forms-spin input[name="_wpnonce"]').value,i=WOF_LocalizeConfig?.wheel_data?.frontEndVisibility?.campaign_name,l=document.querySelector(".spin-wheel-forms-spin");t&&o?(l.querySelector("button").setAttribute("disabled","disabled"),document.querySelector(".spin-wheel-form-loader").classList.remove("spin-wheel-hidden"),this.setCookie("wof_name",t,15),this.setCookie("wof_email",o,15),this.setCookie("wof_campaign",i,15),this.setCookie("nonce",n,15),this.handleSpinClick()):console.error("Name or email is missing!")}}))},probability:function(e){e.forEach((e=>{void 0===e.probability||0===e.probability?e.probability=1:e.probability=parseInt(e.probability,10)}));const t=e.reduce(((e,t)=>e+t.probability),0);let o=0;const n=e.map(((e,n)=>(o+=e.probability/t,{label:e.label,cumulativeProbability:o,index:n}))),i=Math.random();for(let e of n)if(i<=e.cumulativeProbability)return{selectedCoupon:e.label,selectedIndex:e.index};return null},handleSpinClick:function(){const{duration:e,winningItemRotaion:t}=this.calcSpinToValues(),o=WOF_LocalizeConfig?.wheel_data?.coupons?.some((e=>e.probability));if(1==o){let t=this.probability(WOF_LocalizeConfig?.wheel_data?.coupons).selectedIndex;this.wheel.spinToItem(t,e,!0,2,1,easingFunction=null)}else this.wheel.spinTo(t,e)},calcSpinToValues:function(){const e=this.getRandomInt(360,630)+this.modifier;return this.modifier+=630,{duration:3e3,winningItemRotaion:e}},getRandomInt:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},getProps:function(){const e=WOF_LocalizeConfig?.wheel_data?.coupons||[];var t=WOF_LocalizeConfig?.wheel_data?.wheelStyles.bgItems||!1;(t=!1!==t&&t?.map((e=>(delete e.label,e.value)))).length||(t=["#b21b00","#f8aa02","#f67b05","#f7994c","#f24101"]);const o={radius:.84,itemLabelRadius:.93,itemLabelRadiusMax:.35,itemLabelRotation:180,itemLabelColors:["#fff"],itemLabelAlign:"left",itemLabelBaselineOffset:-.07,itemLabelFontSizeMax:20,itemBackgroundColors:t,rotationSpeedMax:500,rotationResistance:-100,lineWidth:0,lineColor:"#fff",image:this.imgElement,overlayImage:this.imgOverlayElement,isInteractive:!1,items:e};return"none"==WOF_LocalizeConfig?.wheel_data?.wheelStyles?.othersData?.centerImage&&delete o.image,o},copyToClipboard:function(e){const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},confettiEffect:function(){if(!WOF_LocalizeConfig?.wheel_data?.wheelStyles?.othersData?.confettiEffects)return;const e=Date.now()+5e3,t={startVelocity:30,spread:360,ticks:60,zIndex:0};function o(e,t){return Math.random()*(t-e)+e}const n=setInterval((function(){const i=e-Date.now();if(i<=0)return clearInterval(n);const l=i/5e3*50;confetti(Object.assign({},t,{particleCount:l,origin:{x:o(.1,.3),y:Math.random()-.2}})),confetti(Object.assign({},t,{particleCount:l,origin:{x:o(.7,.9),y:Math.random()-.2}}))}),250)},managePopups:function(e){if(1==e?.win){let o=e.label,n=e.value;document.querySelector(".spin-wheel-spin-step").remove(),document.querySelector(".spin-wheel-form-loader").remove();let i=document.querySelector(".spin-wheel-win-step");i.classList.remove("spin-wheel-hidden");let l=WOF_LocalizeConfig?.wheel_data?.frontEndVisibility?.reappear_time||1;t.setCookie("spin_wheel_popup_closed",!0,l);let r=i.querySelector("h2");if(r.innerHTML=r.innerHTML.replace("{{prize}}",o),e.email_coupon)return document.querySelector(".spin-wheel-win-coupon-wrap").remove(),void(document.querySelector(".spin-wheel-win-step p").innerHTML="Coupon has been sent to your email address.");i.querySelector("#spin-wheel-win-coupon").innerHTML=n,i.querySelector(".spin-wheel-win-coupon-wrap button").addEventListener("click",(()=>{this.copyToClipboard(n);const e=WOF_LocalizeConfig?.wheel_data?.wheelStyles?.win_info||!1;i.querySelector(".spin-wheel-win-coupon-wrap button").innerHTML=e?.buttonTextCopied?e.buttonTextCopied:"Copied!"})),this.confettiEffect()}else{document.querySelector(".spin-wheel-spin-step").remove(),document.querySelector(".spin-wheel-form-loader").remove(),document.querySelector(".spin-wheel-win-coupon-wrap").remove();let o=document.querySelector(".spin-wheel-win-step");o.classList.remove("spin-wheel-hidden"),"already_revealed"===e?.error&&(o.querySelector("h2").innerHTML="Oops, you have already revealed the coupon."),o.querySelector("p").innerHTML="";let n=WOF_LocalizeConfig?.wheel_data?.frontEndVisibility?.reappear_time||1;t.setCookie("spin_wheel_popup_closed",!0,n)}},revealCouponCode:async function(e){let o=WOF_LocalizeConfig.ajaxurl,n=new XMLHttpRequest;n.open("POST",o,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status){let e=JSON.parse(n.responseText);t.managePopups(e?.data?.data||e?.data)}else console.error("Error:",n.status,n.statusText)};const i=t.getCookie("wof_campaign"),l=t.getCookie("wof_email"),r=t.getCookie("wof_name"),s=WOF_LocalizeConfig.nonce;let a=new URLSearchParams;a.append("action","reveal_coupon"),a.append("couponID",e),a.append("nonce",s),a.append("email",l),a.append("name",r),a.append("campaign",i),n.send(a)},onRestEvent:function(e){let t=e.currentIndex;setTimeout((()=>{this.revealCouponCode(t)}),500)},showPopup:function(){if(document.querySelector(".spin-wheel-wrapper")){MicroModal.show("wof__modal");let e=WOF_LocalizeConfig?.wheel_data?.frontEndVisibility?.reappear_time||1;this.setCookie("spin_wheel_popup_closed",!0,e)}},isVisible:function(){const e=WOF_LocalizeConfig?.wheel_data?.frontEndVisibility;if("on_page_load"===e?.display_option){setTimeout((()=>{this.showPopup()}),1e3*e?.show_after_time||500)}if("on_exit"===e?.display_option&&document.addEventListener("mouseleave",(()=>{this.showPopup()})),"on_scroll"===e?.display_option&&window.addEventListener("scroll",(()=>{Math.round((document.documentElement.scrollTop+document.body.scrollTop)/(document.documentElement.scrollHeight-document.documentElement.clientHeight)*100)>=e?.show_on_scroll_percent&&t.showPopup()})),"on_click"===e?.display_option&&1==WOF_LocalizeConfig?.isPro){let o=document.querySelector(e?.on_click_selectors);o&&o.addEventListener("click",(()=>{t.showPopup()}))}let o;const n=1e3*e?.show_on_inactivity_time||5e3;if("on_inactivity"===e?.display_option){const e=()=>{clearTimeout(o),o=setTimeout((()=>{t.showPopup()}),n)};document.addEventListener("mousemove",e),e()}if("on_referrer"===e?.display_option&&1==WOF_LocalizeConfig?.isPro){const o=e?.referrer_contains||"";document.referrer.includes(o)&&t.showPopup()}return!0},setStyles:function(){const e=WOF_LocalizeConfig?.wheel_data?.wheelStyles?.submit_form||!1,t=WOF_LocalizeConfig?.wheel_data?.wheelStyles?.win_info||!1;if(e){let t=document.querySelector(".spin-wheel-forms-spin h2"),o=document.querySelector(".spin-wheel-forms-spin p"),n=document.querySelectorAll(".spin-wheel-forms-spin input"),i=document.querySelector(".spin-wheel-forms-spin button");e.bodyBg&&(document.querySelector(".spin-wheel-spin-wrapper").style.background=e.bodyBg),e.title&&(t.innerHTML=e.title),e.titleAlignment&&(t.style.textAlign=e.titleAlignment),e.titleColor&&(t.style.color=e.titleColor),e.titleSize&&(t.style.fontSize=e.titleSize),e.desc&&(o.innerHTML=e.desc),e.descAlignment&&(o.style.textAlign=e.descAlignment),e.descColor&&(o.style.color=e.descColor),e.descSize&&(o.style.fontSize=e.descSize),e.inputColor&&n.forEach((t=>{t.style.color=e.inputColor})),e.inputBg&&n.forEach((t=>{t.style.backgroundColor=e.inputBg})),e.inputBorderColor&&n.forEach((t=>{t.style.borderColor=e.inputBorderColor})),e.inputBorderRadius&&n.forEach((t=>{t.style.borderRadius=e.inputBorderRadius})),e.inputSize&&n.forEach((t=>{t.style.fontSize=e.inputSize})),e.buttonAlignment&&(i.style.textAlign=e.buttonAlignment,"justify"===e.buttonAlignment&&(i.style.width="100%",i.style.textAlign="center")),e.buttonText&&(i.innerHTML=e.buttonText),e.buttonBackground&&(i.style.backgroundColor=e.buttonBackground),e.buttonBorderColor&&(i.style.borderColor=e.buttonBorderColor),e.buttonColor&&(i.style.color=e.buttonColor),e.buttonFontSize&&(i.style.fontSize=e.buttonFontSize)}if(t){let e=document.querySelector(".spin-wheel-win-step h2"),o=document.querySelector(".spin-wheel-win-step p"),n=document.querySelector(".spin-wheel-win-coupon-wrap pre"),i=document.querySelector(".spin-wheel-win-step button");t.title&&(e.innerHTML=t.title),t.titleAlignment&&(e.style.textAlign=t.titleAlignment),t.titleColor&&(e.style.color=t.titleColor),t.titleSize&&(e.style.fontSize=t.titleSize),t.desc&&(o.innerHTML=t.desc),t.descAlignment&&(o.style.textAlign=t.descAlignment),t.descColor&&(o.style.color=t.descColor),t.descSize&&(o.style.fontSize=t.descSize),t.inputColor&&(n.style.color=t.inputColor),t.inputBorderColor&&(n.style.borderColor=t.inputBorderColor),t.inputBackground&&(n.style.backgroundColor=t.inputBackground),t.inputSize&&(n.style.fontSize=t.inputSize),t.buttonText&&(i.innerHTML=t.buttonText),t.buttonColor&&(i.style.color=t.buttonColor),t.buttonBackground&&(i.style.backgroundColor=t.buttonBackground),t.buttonBorderColor&&(i.style.borderColor=t.buttonBorderColor),t.buttonFontSize&&(i.style.fontSize=t.buttonFontSize)}},validateCookie:function(){return!0===WOF_LocalizeConfig?.wheel_data?.frontEndVisibility?.dev_mode||!this.getCookie("spin_wheel_popup_closed")&&!this.getCookie("spin_wheel_popup_dont_feel_lucky")},init:function(){this.validateCookie()&&(document.querySelector(".spin-wheel-close-icon").addEventListener("click",(()=>{MicroModal.close("wof__modal");let e=WOF_LocalizeConfig?.wheel_data?.frontEndVisibility?.reappear_time||1;t.setCookie("spin_wheel_popup_closed",!0,e)})),this.createImages(),this.props=this.getProps(),this.modifier=0,this.setupWheel(),this.bindEvents(),this.wheel.onRest=e=>this.onRestEvent(e),this.isVisible(),this.setStyles())}};document.addEventListener("DOMContentLoaded",(function(){const e=WOF_LocalizeConfig?.wheel_data?.frontEndVisibility,o=window.matchMedia("(min-width: 1025px)").matches,n=window.matchMedia("(min-width: 768px) and (max-width: 1024px)").matches,i=window.matchMedia("(max-width: 767px)").matches;(e?.visibility_desktop&&o||e?.visibility_tablet&&n||e?.visibility_mobile&&i)&&t.init()}))}();